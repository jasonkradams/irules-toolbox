# iRule to block access to URIs which contain /down.php, unless the cilient is connecting from  75.66.12.0/255.255.255.0 or 15.150.0.0/255.255.0.0

when HTTP_REQUEST {
    log local0. " Request in [IP::client_addr] [HTTP::host][HTTP::uri]"
    if { ( [HTTP::uri -normalized] contains "/down.php" ) and not ( ( [IP::addr [IP::client_addr] equals 75.66.12.0/255.255.255.0] ) or ( [IP::addr [IP::client_addr] equals 15.150.0.0/255.255.0.0] ) ) } {
        log local0. " Blocked access [IP::client_addr] [HTTP::host][HTTP::uri]"
        # drop the request
        reject
    }
}
